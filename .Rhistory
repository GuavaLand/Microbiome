HOI_SS10[i,j-1] <-  FindSS(dat[,j])
}
#Original GLV
for (k in 2:ncol(dat1)) {
GLV_SS10[i,k-1] <-  FindSS(dat[,k])
}
}
#N <-  20
#HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
#GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
#for (i in 1:numTrial) {
#  source('DensityMediated_varyingCoefficientLinear.R')
#  #Modified GLV
#  for (j in 2:ncol(dat)) {
#    HOI_SS20[1,j-1] <-  FindSS(dat[,j])
#  }
#
#  #Original GLV
#  for (j in 2:ncol(dat1)) {
#    GLV_SS20[1,j-1] <-  FindSS(dat[,j])
#  }
#}
source('FindSS.R')
#source('ML_DensityMediated_RandomForest.R')
N <-  10
numTrial = 2
HOI_SS10 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS10 <-  matrix(nrow = numTrial, ncol = N)
for (i in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (j in 2:ncol(dat)) {
browser()
HOI_SS10[i,j-1] <-  FindSS(dat[,j])
}
#Original GLV
for (k in 2:ncol(dat1)) {
GLV_SS10[i,k-1] <-  FindSS(dat[,k])
}
}
#N <-  20
#HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
#GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
#for (i in 1:numTrial) {
#  source('DensityMediated_varyingCoefficientLinear.R')
#  #Modified GLV
#  for (j in 2:ncol(dat)) {
#    HOI_SS20[1,j-1] <-  FindSS(dat[,j])
#  }
#
#  #Original GLV
#  for (j in 2:ncol(dat1)) {
#    GLV_SS20[1,j-1] <-  FindSS(dat[,j])
#  }
#}
source('FindSS.R')
#source('ML_DensityMediated_RandomForest.R')
N <-  10
numTrial = 2
HOI_SS10 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS10 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
browser()
HOI_SS10[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS10[trial,oSpecies-1] <-  FindSS(dat[,oSpecies])
}
}
#N <-  20
#HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
#GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
#for (i in 1:numTrial) {
#  source('DensityMediated_varyingCoefficientLinear.R')
#  #Modified GLV
#  for (j in 2:ncol(dat)) {
#    HOI_SS20[1,j-1] <-  FindSS(dat[,j])
#  }
#
#  #Original GLV
#  for (j in 2:ncol(dat1)) {
#    GLV_SS20[1,j-1] <-  FindSS(dat[,j])
#  }
#}
source('FindSS.R')
#source('ML_DensityMediated_RandomForest.R')
N <-  10
numTrial = 2
HOI_SS10 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS10 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS10[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS10[trial,oSpecies-1] <-  FindSS(dat[,oSpecies])
}
}
#N <-  20
#HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
#GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
#for (i in 1:numTrial) {
#  source('DensityMediated_varyingCoefficientLinear.R')
#  #Modified GLV
#  for (j in 2:ncol(dat)) {
#    HOI_SS20[1,j-1] <-  FindSS(dat[,j])
#  }
#
#  #Original GLV
#  for (j in 2:ncol(dat1)) {
#    GLV_SS20[1,j-1] <-  FindSS(dat[,j])
#  }
#}
source('FindSS.R')
#source('ML_DensityMediated_RandomForest.R')
N <-  10
numTrial = 2
HOI_SS10 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS10 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS10[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS10[trial,oSpecies-1] <-  FindSS(dat[,oSpecies])
}
}
#N <-  20
#HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
#GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
#for (i in 1:numTrial) {
#  source('DensityMediated_varyingCoefficientLinear.R')
#  #Modified GLV
#  for (j in 2:ncol(dat)) {
#    HOI_SS20[1,j-1] <-  FindSS(dat[,j])
#  }
#
#  #Original GLV
#  for (j in 2:ncol(dat1)) {
#    GLV_SS20[1,j-1] <-  FindSS(dat[,j])
#  }
#}
HOI_SS10
source('FindSS.R')
#source('ML_DensityMediated_RandomForest.R')
N <-  10
numTrial = 2
HOI_SS10 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS10 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS10[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS10[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
N <-  20
HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS20[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS20[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
N <-  30
HOI_SS30 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS30 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS30[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS30[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
GLV_SS10
GLV_SS20
FindSS <- function(vec){
for (i in 1:(length(vec) - 10)) {
#From start, search for 3 points each 5 unit time apart where delta < 10^-3
thisSlope <- abs(vec[i+1] - vec[i])
nextSlope <- abs(vec[i+5] - vec[i+4])
lastSlope <- abs(vec[i+10] - vec[i+9])
if (thisSlope < 10^-3 & nextSlope < 10^-3 & lastSlope < 10^-3) {
#Verification: make sure no change after plateau: extrapolate
#Extrapolate by thisSlope and calculate value at end of integration time
ExtrEndTimeValue = vec[i] + lastSlope*(length(vec) - i)
if ((ExtrEndTimeValue < (vec[length(vec)]) + 0.01)& (ExtrEndTimeValue > (vec[length(vec)]) - 0.01)) {
return(i)
}
#There is a plateau in the middle, but in the end density changes again: find next plateau and verify agin
}
}
#Til the end no steady state found
return(NaN)
}
source('FindSS.R')
#source('ML_DensityMediated_RandomForest.R')
N <-  10
numTrial = 2
HOI_SS10 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS10 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS10[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS10[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
N <-  20
HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS20[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS20[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
#N <-  30
#HOI_SS30 <-  matrix(nrow = numTrial, ncol = N)
#GLV_SS30 <-  matrix(nrow = numTrial, ncol = N)
#
#for (trial in 1:numTrial) {
#  source('DensityMediated_varyingCoefficientLinear.R')
#  #Modified GLV
#  for (species in 2:ncol(dat)) {
#    HOI_SS30[trial,species-1] <-  FindSS(dat[,species])
#  }
#
#  #Original GLV
#  for (oSpecies in 2:ncol(dat1)) {
#    GLV_SS30[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
#  }
#}
source('FindSS.R')
#source('ML_DensityMediated_RandomForest.R')
N <-  10
numTrial = 2
HOI_SS10 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS10 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS10[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS10[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
N <-  20
HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS20[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS20[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
#N <-  30
#HOI_SS30 <-  matrix(nrow = numTrial, ncol = N)
#GLV_SS30 <-  matrix(nrow = numTrial, ncol = N)
#
#for (trial in 1:numTrial) {
#  source('DensityMediated_varyingCoefficientLinear.R')
#  #Modified GLV
#  for (species in 2:ncol(dat)) {
#    HOI_SS30[trial,species-1] <-  FindSS(dat[,species])
#  }
#
#  #Original GLV
#  for (oSpecies in 2:ncol(dat1)) {
#    GLV_SS30[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
#  }
#}
GLV_SS20
dat1[,4]
dat1[,5]
1.10408510 - 1.103538
(1.10408510 - 1.103538) * (400-164)
1.102+0.12911
source('FindSS.R')
#source('ML_DensityMediated_RandomForest.R')
N <-  10
numTrial = 2
HOI_SS10 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS10 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS10[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS10[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
N <-  20
HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS20[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS20[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
#N <-  30
#HOI_SS30 <-  matrix(nrow = numTrial, ncol = N)
#GLV_SS30 <-  matrix(nrow = numTrial, ncol = N)
#
#for (trial in 1:numTrial) {
#  source('DensityMediated_varyingCoefficientLinear.R')
#  #Modified GLV
#  for (species in 2:ncol(dat)) {
#    HOI_SS30[trial,species-1] <-  FindSS(dat[,species])
#  }
#
#  #Original GLV
#  for (oSpecies in 2:ncol(dat1)) {
#    GLV_SS30[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
#  }
#}
source('FindSS.R')
#source('ML_DensityMediated_RandomForest.R')
N <-  10
numTrial = 2
HOI_SS10 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS10 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS10[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS10[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
N <-  20
HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS20[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS20[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
#N <-  30
#HOI_SS30 <-  matrix(nrow = numTrial, ncol = N)
#GLV_SS30 <-  matrix(nrow = numTrial, ncol = N)
#
#for (trial in 1:numTrial) {
#  source('DensityMediated_varyingCoefficientLinear.R')
#  #Modified GLV
#  for (species in 2:ncol(dat)) {
#    HOI_SS30[trial,species-1] <-  FindSS(dat[,species])
#  }
#
#  #Original GLV
#  for (oSpecies in 2:ncol(dat1)) {
#    GLV_SS30[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
#  }
#}
GLV_SS20
GLV_SS10
source('FindSS.R')
#source('ML_DensityMediated_RandomForest.R')
N <-  10
numTrial = 2
HOI_SS10 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS10 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS10[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS10[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
N <-  20
HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS20[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS20[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
#N <-  30
#HOI_SS30 <-  matrix(nrow = numTrial, ncol = N)
#GLV_SS30 <-  matrix(nrow = numTrial, ncol = N)
#
#for (trial in 1:numTrial) {
#  source('DensityMediated_varyingCoefficientLinear.R')
#  #Modified GLV
#  for (species in 2:ncol(dat)) {
#    HOI_SS30[trial,species-1] <-  FindSS(dat[,species])
#  }
#
#  #Original GLV
#  for (oSpecies in 2:ncol(dat1)) {
#    GLV_SS30[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
#  }
#}
source('FindSS.R')
#source('ML_DensityMediated_RandomForest.R')
N <-  10
numTrial = 1000
HOI_SS10 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS10 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS10[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS10[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
N <-  20
HOI_SS20 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS20 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS20[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS20[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
N <-  30
HOI_SS30 <-  matrix(nrow = numTrial, ncol = N)
GLV_SS30 <-  matrix(nrow = numTrial, ncol = N)
for (trial in 1:numTrial) {
source('DensityMediated_varyingCoefficientLinear.R')
#Modified GLV
for (species in 2:ncol(dat)) {
HOI_SS30[trial,species-1] <-  FindSS(dat[,species])
}
#Original GLV
for (oSpecies in 2:ncol(dat1)) {
GLV_SS30[trial,oSpecies-1] <-  FindSS(dat1[,oSpecies])
}
}
HOI_SS10
HOI_SS20
dat
tail(dat)
tail(dat1)
